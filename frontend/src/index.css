@import "tailwindcss";
@import "../styles/themes/index.css";
@import "bootstrap-icons/font/bootstrap-icons.css";

/* Tailwind v4 theme definition - uses var() references to theme CSS variables */
@theme inline {
  /* Backgrounds */
  --color-bg0: var(--bg0);
  --color-bg1: var(--bg1);
  --color-bg2: var(--bg2);
  --color-bg3: var(--bg3);
  --color-bg4: var(--bg4);
  --color-bg-h: var(--bg-h);

  /* Foregrounds */
  --color-fg0: var(--fg0);
  --color-fg1: var(--fg1);
  --color-fg2: var(--fg2);
  --color-fg3: var(--fg3);
  --color-fg4: var(--fg4);
  --color-gray: var(--gray);
  --color-primary: var(--fg1);
  --color-secondary: var(--gray);
  --color-tertiary: var(--fg4);
  --color-muted: var(--fg4);

  /* Accent colors */
  --color-aqua: var(--aqua);
  --color-aqua-bright: var(--aqua-bright);
  --color-accent: var(--accent);
  --color-accent-bright: var(--accent-bright);
  --color-red: var(--red);
  --color-red-bright: var(--red-bright);
  --color-green: var(--green);
  --color-green-bright: var(--green-bright);
  --color-blue: var(--blue);
  --color-blue-bright: var(--blue-bright);
  --color-yellow: var(--yellow);
  --color-yellow-bright: var(--yellow-bright);
  --color-purple: var(--purple);
  --color-purple-bright: var(--purple-bright);
  --color-orange: var(--orange);
  --color-orange-bright: var(--orange-bright);
}

/* Font Faces - CommitMonoFunky */
@font-face {
  font-family: "CommitMonoFunky";
  src: url("/fonts/CommitMonoFunky-400-Regular.otf") format("opentype");
  font-weight: 400;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: "CommitMonoFunky";
  src: url("/fonts/CommitMonoFunky-400-Italic.otf") format("opentype");
  font-weight: 400;
  font-style: italic;
  font-display: swap;
}

@font-face {
  font-family: "CommitMonoFunky";
  src: url("/fonts/CommitMonoFunky-700-Regular.otf") format("opentype");
  font-weight: 700;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: "CommitMonoFunky";
  src: url("/fonts/CommitMonoFunky-700-Italic.otf") format("opentype");
  font-weight: 700;
  font-style: italic;
  font-display: swap;
}

/* Font Faces - Manrope */
@font-face {
  font-family: "Manrope";
  src: url("/fonts/Manrope-Regular.ttf") format("truetype");
  font-weight: 400;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: "Manrope";
  src: url("/fonts/Manrope-Medium.ttf") format("truetype");
  font-weight: 500;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: "Manrope";
  src: url("/fonts/Manrope-SemiBold.ttf") format("truetype");
  font-weight: 600;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: "Manrope";
  src: url("/fonts/Manrope-Bold.ttf") format("truetype");
  font-weight: 700;
  font-style: normal;
  font-display: swap;
}

:root {
  /* Fluid typography - prevents tiny text on 4K/8K displays */
  font-size: clamp(100%, 0.9rem + 0.3vw, 112.5%);
  /* Min: 16px, Max: 18px */

  /* Font families */
  --font-display: "Manrope", -apple-system, BlinkMacSystemFont, sans-serif;
  --font-mono: "CommitMonoFunky", "Monaco", "Menlo", monospace;

  /* Type scale (rem) */
  --font-h1: 2rem; /* 32px at base */
  --font-h2: 1.5rem; /* 24px */
  --font-h3: 1.25rem; /* 20px */
  --font-base: 0.875rem; /* 14px */
  --font-small: 0.75rem; /* 12px */
  --font-tiny: 0.6875rem; /* 11px */

  /* Spacing system (all rem - scales with font) */
  --spacing-xs: 0.25rem; /* 4px */
  --spacing-sm: 0.5rem; /* 8px */
  --spacing-md: 0.75rem; /* 12px */
  --spacing-lg: 1rem; /* 16px */
  --spacing-xl: 1.5rem; /* 24px */
  --spacing-2xl: 2rem; /* 32px */

  /* Borders (px only - sub-pixel borders look broken) */
  --border-thin: 1px;
  --border-medium: 2px;

  /* Border radius */
  --border-radius-sm: 0.25rem; /* 4px */
  --border-radius-md: 0.5rem; /* 8px */
  --border-radius-lg: 0.75rem; /* 12px */

  /* Transitions - consistent 0.2s ease throughout */
  --transition-fast: 0.2s ease;
  /* Applied to: hover states, color changes, background changes, border colors */

  /* Touch targets (accessibility) */
  --touch-target-min: 2.75rem; /* 44px minimum for mobile */

  /* Color variables are defined in frontend/styles/themes/*.css files */
  /* gruvbox-dark.css provides :root defaults for all colors */
}

/* Theme colors are now defined in frontend/styles/themes/*.css files */

/* Links - standardized pattern */
/* Note: Removed global 'a' selector - it was overriding Tailwind text utilities */
/* Links now use explicit Tailwind classes for full control */

a {
  text-decoration: none;
}

/* Navigation links (top nav, sidebar) - use accent by default */
.nav-link {
  color: var(--accent);
  text-decoration: none;
  transition: color var(--transition-fast);
}

.nav-link:hover,
.nav-link.active {
  color: var(--accent-bright);
}

body {
  margin: 0;
  background-color: var(--bg0);
  color: var(--fg1);
  font-family: var(--font-mono);
  font-size: var(--font-base);
  line-height: 1.5;
}

/* Headings use display font */
h1,
h2,
h3,
h4,
h5,
h6 {
  font-family: var(--font-display);
  font-weight: 600;
}

h1 {
  font-size: var(--font-h1);
  line-height: 1.2;
}

h2 {
  font-size: var(--font-h2);
  line-height: 1.3;
}

h3 {
  font-size: var(--font-h3);
  line-height: 1.4;
}

/* Minimum touch target utility */
.touch-target {
  min-height: var(--touch-target-min);
  min-width: var(--touch-target-min);
}

/* Background utilities */
.bg-primary {
  background-color: var(--bg0);
}
.bg-secondary {
  background-color: var(--bg1);
}
.bg-tertiary {
  background-color: var(--bg2);
}

/* Text color utilities */
.text-primary {
  color: var(--fg1);
}
.text-secondary {
  color: var(--fg4);
}
.text-muted {
  color: var(--fg4);
}
.text-bg-primary {
  color: var(--bg0);
}

/* Border utilities - REMOVED to let Tailwind handle them via @theme */
/* .border-primary, .border-secondary, .border-tertiary, .border-muted are now generated by Tailwind */

/* Border color utilities - explicit for Tailwind v4 custom colors */
@layer utilities {
  .border-aqua {
    border-color: var(--aqua);
  }
  .border-aqua-bright {
    border-color: var(--aqua-bright);
  }
  .border-red {
    border-color: var(--red);
  }
  .border-red-bright {
    border-color: var(--red-bright);
  }
  .border-green {
    border-color: var(--green);
  }
  .border-green-bright {
    border-color: var(--green-bright);
  }
  .border-blue {
    border-color: var(--blue);
  }
  .border-blue-bright {
    border-color: var(--blue-bright);
  }
  .border-orange {
    border-color: var(--orange);
  }
  .border-orange-bright {
    border-color: var(--orange-bright);
  }
  .border-yellow {
    border-color: var(--yellow);
  }
  .border-yellow-bright {
    border-color: var(--yellow-bright);
  }
  .border-purple {
    border-color: var(--purple);
  }
  .border-purple-bright {
    border-color: var(--purple-bright);
  }
  .border-accent {
    border-color: var(--accent);
  }
  .border-accent-bright {
    border-color: var(--accent-bright);
  }
}

input[type="date"],
input[type="datetime-local"] {
  color-scheme: dark;
}

[data-theme="gruvbox-light"] input[type="date"],
[data-theme="gruvbox-light"] input[type="datetime-local"] {
  color-scheme: light;
}

input[type="date"]::-webkit-calendar-picker-indicator,
input[type="datetime-local"]::-webkit-calendar-picker-indicator {
  filter: invert(0.7);
  cursor: pointer;
  transition: filter 0.2s ease;
}

input[type="date"]:hover::-webkit-calendar-picker-indicator,
input[type="datetime-local"]:hover::-webkit-calendar-picker-indicator {
  filter: invert(0.9);
}

[data-theme="gruvbox-light"] input[type="date"]::-webkit-calendar-picker-indicator,
[data-theme="gruvbox-light"] input[type="datetime-local"]::-webkit-calendar-picker-indicator {
  filter: none;
}

[data-theme="gruvbox-light"] input[type="date"]:hover::-webkit-calendar-picker-indicator,
[data-theme="gruvbox-light"] input[type="datetime-local"]:hover::-webkit-calendar-picker-indicator {
  filter: invert(0.2);
}

/* Systematic text wrapping - prevents overflow everywhere */
body {
  overflow-wrap: break-word;
  hyphens: auto;
  word-break: normal;
}

/* Table-specific rules (critical for applications list) */
table {
  table-layout: fixed;
}

td,
th {
  overflow-wrap: break-word;
  max-width: 0;
}

/* Progressive enhancement for modern browsers */
h1,
h2,
h3 {
  text-wrap: balance;
}

@supports (text-wrap: pretty) {
  p,
  li {
    text-wrap: pretty;
  }
}

table {
  table-layout: fixed;
}

td,
th {
  white-space: normal;
  overflow-wrap: break-word;
  word-break: break-word;
  max-width: 0;
}

/* Spinner animation */
@keyframes spin {
  to {
    transform: rotate(360deg);
  }
}

.animate-spin {
  animation: spin 0.8s linear infinite;
}

/* Focus indicators - visible and consistent */
:focus-visible {
  outline: 2px solid var(--accent-bright);
  outline-offset: 2px;
}

/* Remove default focus for mouse users, keep for keyboard */
:focus:not(:focus-visible) {
  outline: none;
}

/* Button focus */
button:focus-visible {
  outline: 2px solid var(--accent-bright);
  outline-offset: 2px;
}

/* Input focus - handled by border-color change, no outline needed */
input:focus-visible,
select:focus-visible,
textarea:focus-visible {
  outline: none;
}

/* Link focus */
a:focus-visible {
  outline: 2px solid var(--accent-bright);
  outline-offset: 2px;
}

/* Icon sizing - Bootstrap Icons ::before override */
/* Bootstrap Icons are font-based and rendered in ::before pseudo-element.
   The ::before needs to inherit font-size from parent element for sizing to work.
   This override ensures icon-sizing utilities work correctly. */
.bi::before {
  font-size: inherit !important;
}

/* Icon sizing utilities */
/* Use these for consistent icon sizing across the application.
   Bootstrap Icons inherit font-size from parent via .bi::before override. */
.icon-xs {
  font-size: 0.75rem;   /* 12px - table action buttons */
  line-height: 1;
}
.icon-sm {
  font-size: 0.875rem;  /* 14px - standard action buttons */
  line-height: 1;
}
.icon-md {
  font-size: 1rem;      /* 16px - media type indicators */
  line-height: 1;
}
.icon-lg {
  font-size: 1.125rem;  /* 18px - larger icons */
  line-height: 1;
}
.icon-xl {
  font-size: 1.25rem;   /* 20px - modal close buttons, dashboard icons */
  line-height: 1;
}
.icon-2xl {
  font-size: 3rem;      /* 48px - empty state decorative icons */
  line-height: 1;
}

/* Flicker animation for Flame of Focus */
@keyframes flicker {
  0%,
  100% {
    opacity: 1;
    transform: scale(1);
  }
  25% {
    opacity: 0.95;
    transform: scale(0.98);
  }
  50% {
    opacity: 1;
    transform: scale(1.02);
  }
  75% {
    opacity: 0.97;
    transform: scale(0.99);
  }
}

/* Screen reader only utility */
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}
